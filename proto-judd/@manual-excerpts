Judd Communications Depth Sensor

INTRODUCTION

The Judd Communications Depth Sensor is an inexpensive solution for
remotely measuring snow depth or water levels. The sensor measures
the distance from the sensor to a target. The sensor works by
measuring the time required for an ultrasonic pulse to travel to
and from a target surface. An integrated temperature probe with
solar radiation shield, provides an air temperature measurement for
properly compensating the distance measured. An embedded microcontroller
calculates a temperature compensated distance and performs error
checking.

Both distance and air temperature can be output as an analog signal
between 0 to 2.5 Volts or 0 to 5 Volts.  The depth sensor is user
configurable by means of internal dip switches. Several configurations
are possible and allow the depth sensor to work with as many different
type of systems as possible.  Accurate measurement of snow depth
poses many difficult problems. The Judd Communications Depth Sensor
has proven very effective in measuring snow depth, which makes it
well suited for other various applications.


OPERATION

Ultrasonic simply means sound waves that are above the range of
human hearing in frequency. The depth sensor’s ultrasonic ranging
system operates at a frequency of 50 kilohertz (50,000 cycles). The
key component of the ultrasonic system is the transducer. The
transducer is first used as a speaker to transmit an ultrasonic
pulse, then it is used as a microphone to listen for the pulse after
being reflected off a surface. By measuring the amount of time that
it takes the ultrasonic pulse to travel from the transducer to a
surface and back again, a distance can be calculated.

The Judd Communications Depth Sensor outputs an analog signals that
are proportional to the distance and air temperature being measured.
Both measurements are output sequentially through a single output.
The output signal has two ranges: 0 to 2.5 Volts or 0 to 5 Volts.
The range is selected by a jumper on the main circuit board. The
output signals can be can be scaled using the following multipliers:

    Distance [cm]:
        0-2.5 Volt range:   500 cm/Volt
        0-5 Volt range:     250 cm/Volt
        
    Air Temperature [Kelvin]:
        0-2.5 Volt range:   200 degrees/Volt
        0-5 Volt range:     100 degrees/Volt

The JC Depth Sensor performs multiple echo processing. Multiple
echo processing dramatically improves the reliability of measurements.
For each measurement cycle, two initial measurements are made. If
the difference between the two distances is less than 1 centimeter,
then the second sample is saved, and output. If the difference
between the two samples is greater than 1 centimeter, then the
oldest sample is discarded and another measurement is made and
another comparison is made. This retry algorithm will continue up
to a maximum of ten times. When a valid measurement can not made,
or no echo is returned, a value of zero is output. When a zero is
output to the digital to analog converter, the output voltage is
typically in the range of 3-5 millivolts.


SENSOR WIRING

    Color   Function        Datalogger Connection
    ----------------------------------------------------------
    Red     +12V            +12V
    Black   Ground          Ground
    Clear   Shield          Ground
    Green   Sensor Enable   2.5 to 12 V Control Port
    White   Output High     Single or Differential input High*
    Brown   Output Low      Differential input Low*
    *When single ended inputs are used, the Brown lead is not used.


SENSOR PROGRAMMING

The following steps show how to make temperature and depth measurements
with the JC Depth Sensor.

1. Turn on the sensor by applying a +5 to +12 Volt control signal
to the green lead.

2. Wait for 800 milliseconds for the depth sensor to warm up and
output a temperature measurement.

3. Sample the Air Temp. output by making a differential voltage
measurement between the white (+) and the brown lead (-).

4. Wait for 1800 milliseconds for the depth sensor to output a
distance measurement.

5. Sample the Distance output by making a differential voltage
measurement between the white (+) and the brown lead (-).

6. Reset and turn off the sensor by removing the control signal
from the green lead.


INSTALLATION

When mounting the sensor pay careful attention to the cone of the
ultrasonic beam. The beam width is 22 degrees which means that the
diameter of the beam will be 39% of the distance to the target, as
shown in Figure 1. This means that after traveling 10 meters the
beam diameter will be 3.9 meters. In this example the sensor would
need to be mounted at least half the distance of the beam diameter,
or 1.95 meters, away from the mast. Be careful to avoid obstructed
beam paths.

To determine the minimum distance the sensor must be mounted away
from the mast use this formula:

    Crossarm length = .194 x Height

To improve the accuracy of the sensor measurements, mount the sensor
as close to the target as possible.  This will minimize errors that
are a percentage of the distance measured. However, the sensor can
not measure closer than .5 meters to the target, and should be
mounted at least 1 meter away from the target.


MOUNTING

Decide how the sensor will be mounted. Will it be attached to an
existing structure or will it be mounted on a separate stand?

(See manual for diagrams and more details.)


MAINTENANCE

When properly installed, the JC Depth Sensor should require minimal
maintenance. To prevent condensation, a desiccant pack is located
inside the sensor and should be inspected whenever the sensor is
opened. Try to avoid opening the sensor, especially in a humid
environment. Feel the desiccant pack to determine its condition.
If the clay granules feel hard and grainy, the desiccant is still
dry. If the clay granules feel soft, they have soaked up moisture
and the packet should be replaced. Used desiccant packs can be
reactivated by warming them to 250° F for 16 hours. Replacements
can be ordered from Judd Communications. See the following section
for instructions on how to open the sensor housing.

The Solar Radiation Shield on the bottom of the sensor is made of
white PVC plastic, and will yellow after several years of exposure
to ultraviolet light. The shield is easily removed by gently twisting
it counter-clockwise to unscrew it. Replacement fittings can be
obtained from any plumbing supply store, or ordered from Judd
Communications. Check the shield periodically for discoloration and
to make sure that nest building insects have not taken up residence.


CONFIGURATION

The sensor output has two ranges 0 to 5 volts and 0 to 2.5 volts.
The desired range is selected by a jumper connecting the pin
combinations shown in the circuit board illustration. To access the
output range selection jumpers, remove the nylon bolts that hold
the upper circuit board in place. Carefully lift the upper circuit
board out of the way, exposing the lower circuit board.

The four DIP switches can be used to configure the sensor to operate in different modes. The default
setting is OFF for all four switches.

    Dip Switch Function (switch ON)
        1   Free run mode
        2   Fast free run mode
        3   Temperature compensation disable
        4   Hold air temp. output 1 sec. longer

DIP Switch 1: Free run mode

    Normally the depth sensor makes one measurement upon power up
    and then holds the output until it is powered down. In Free Run
    Mode, the sensor will make continuous repeated measurements
    with a pause of one second between. Only the distance measurement
    is output In Free Run Mode. Normally, when using Free Run Mode,
    the Green Sensor Enable wire would be connected to with the Red
    wire to +12 Volts so the sensor is enabled continuously. The
    measurements are made using the error check retry algorithm so
    the output is updated every 1.5 to 3.5 seconds.

    Free Run Mode is used with systems that need continuous operation.
    It is also useful when the sensor is used with a datalogger or
    control system that can not control the delay between sensor
    enable and sensor output measurement.

DIP Switch 2: Fast free run mode

    Fast Free Run Mode works the same as Free Run Mode only the
    error check retry algorithm is not used.  This allows the sensor
    to make continuous measurements at a rate of 2 per second. If
    Temperature Compensation is turned off (DIP Switch 3), then
    measurements are made at the rate of 4 per second.  Fast Free
    Run Mode is used with systems that need quick updates such as
    robotics and industrial control operations. This mode can also
    be used by those who are implementing their own signal processing
    algorithms.

DIP Switch 3: Temperature compensation disable

    Temperature compensation can be disabled by turning ON this
    switch. With temperature compensation disabled, the sensor will
    output a raw distance measurement.

    This mode is enabled when a user wants to use an external
    temperature measurement, for compensation.  To compensate with
    an external temperature measurement follow these steps:

    	1. Obtain the raw distance measurement from the sensor.
    	(make sure DIP Switch 3 is ON)
    
    	2. Get the external temperature measurement.
    
    	3. Calculate the Correction Factor. CF = ((Temp C. + 273)/273)^.5
    
    	4. Multiply the raw distance by the CF.

DIP Switch 4: Hold air temp. output 1 sec. longer

    600 milliseconds after power up the air temperature measurement
    will be output, and stay on the output for at least 200
    milliseconds before the output changes over to the distance
    measurement. Some dataloggers and control systems do not have
    the ability to make millisecond resolution delays. When DIP
    Switch 4 is turned on, the air temperature measurement is held
    on the output for an addition second for a total of 1.2 seconds.

    This enables dataloggers and control systems with at least one
    second delay resolution to obtain the air temperature measurement.

    Normal sensor timing sequence with DIP switch 4 OFF:
        0 to 400 ms         sensor warm up
        400 to 800 ms       air temp. output
        600 to 2600 ms      error checking
        2600 ms -           distance output

    Sensor timing sequence with DIP switch 4 ON:
        0 to 600 ms         sensor warm up
        600 to 1800 ms      air temp. output
        1800 to 3600 ms     error checking
        3600 ms -           distance output


MISC.

Some control systems and dataloggers want to know minimum and maximum
range values instead of scale multipliers. These values do not
denote the actual maximum range of the sensors.

    Distance:
        Minimum:    0 cm
        Maximum:    1250 cm

    Air Temperature:
        Minimum:    0 degrees Kelvin
        Maximum:    500 degrees Kelvin


